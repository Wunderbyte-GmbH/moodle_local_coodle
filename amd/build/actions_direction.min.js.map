{"version":3,"file":"actions_direction.min.js","sources":["../src/actions_direction.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * Coodle directions Event functions\n * @package    local_coodle\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\n\n/**\n * Defines dataset Actions\n */\nconst ACTIONS = {\n    CHECK: 'local-coodle-todo-check',\n    DELETE: 'local-coodle-delete-direction',\n    UNCHECK: 'local-coodle-todo-uncheck',\n    COLLAPSE: 'local-coodle-todo-collapse',\n    MAKEUSERTODO: 'local-coodle-todo-usertodo',\n};\n\n/**\n * Defines Selectors\n */\nconst SELECTORS = {\n    CARD: '.card-direction',\n};\n\n/**\n * Initialize function\n */\nexport const init = () => {\n    initEventListener();\n    // TODO: delete.\n    // eslint-disable-next-line no-console\n    console.log(\"init actions dircetion\");\n};\n\n/**\n * Initialize function\n */\nconst initEventListener = () => {\n    document.querySelector(SELECTORS.CARD).addEventListener('click', function(e) {\n        let target = e.target;\n        // eslint-disable-next-line no-console\n        console.log(target.dataset.action);\n        if (!target.dataset.action) {\n            // eslint-disable-next-line no-console\n            console.log('nix');\n            return;\n        }\n        switch (target.dataset.action) {\n            case ACTIONS.CHECK:\n                todoCheck(target, target.dataset.id);\n                break;\n            case ACTIONS.DELETE:\n                directionDelete(target, target.dataset.id);\n                break;\n            case ACTIONS.UNCHECK:\n                todoUncheck(target, target.dataset.id);\n                break;\n            case ACTIONS.COLLAPSE:\n                todoCollapse(target, target.dataset.id);\n                break;\n            case ACTIONS.MAKEUSERTODO:\n                todoMakeUserTodo(target, target.dataset.id);\n                break;\n            default:\n                break;\n        }\n    });\n};\n\n/**\n * Marks the todo as completed\n * @param {EventTarget} target the id of the todo\n * @param {Integer} id the id of the todo\n */\nconst todoCheck = (target, id) => {\n    Ajax.call([{\n        methodname: \"local_coodle_change_todo\",\n        args: {\n            'todoid': parseInt(id),\n            'method': 'done',\n        },\n        done: function() {\n            target.closest('li').classList.add('done');\n            switchbuttons(target, 'check', id);\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"ex:\" + ex);\n        },\n    }]);\n};\n\n/**\n * Deletes todo\n * @param {EventTarget} target the id of the todo\n * @param {Integer} id the id of the todo\n */\nconst directionDelete = (target, id) => {\n    Ajax.call([{\n        methodname: \"local_coodle_delete_direction\",\n        args: {\n            'id': parseInt(id),\n        },\n        done: function() {\n            target.closest('[data-type = direction]').remove();\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"ex:\" + ex);\n        },\n    }]);\n};\n\n/**\n * Deletes todo\n * @param {EventTarget} target the id of the todo\n * @param {Integer} id the id of the todo\n */\nconst todoMakeUserTodo = (target, id) => {\n    Ajax.call([{\n        methodname: \"local_coodle_change_todo\",\n        args: {\n            'todoid': parseInt(id),\n            'method': 'usertodo',\n        },\n        done: function() {\n            target.closest('li').classList.add('usertodo');\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"ex:\" + ex);\n        },\n    }]);\n};\n\n/**\n * Deletes todo\n * @param {EventTarget} target the id of the todo\n * @param {Integer} id the id of the todo\n */\nconst todoUncheck = (target, id) => {\n    Ajax.call([{\n        methodname: \"local_coodle_change_todo\",\n        args: {\n            'todoid': parseInt(id),\n            'method': 'uncheck',\n        },\n        done: function() {\n            target.closest('li').classList.remove('done');\n            switchbuttons(target, 'uncheck', id);\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"ex:\" + ex);\n        },\n    }]);\n};\n\n/**\n * Collapses todos for client\n * @param {Integer} userid\n */\nconst todoCollapse = (userid) => {\n    // eslint-disable-next-line no-console\n    console.log('collapse' + userid);\n};\n\nconst switchbuttons = (target, mode, id) => {\n    let html = '';\n    if (mode == 'uncheck') {\n        html = '<button class=\"btn btn-primary-outline coodle-checkbutton pull-right\"' +\n        'data-action=\"local-coodle-todo-check\" data-id=\"' +\n        id +\n        '\"><i class=\"fa fa-check-square-o fa-2x text-success \" aria-hidden=\"true\" data-action=\"local-coodle-todo-check\" data-id=\"' +\n        id +\n        '\"></i></button>';\n    }\n    if (mode == 'check') {\n        html = '<button class=\"btn btn-primary-outline coodle-checkbutton pull-right\"' +\n        'data-action=\"local-coodle-todo-uncheck\" data-id=\"' +\n        id + '\"><i class=\"fa fa-play fa-2x text-success \" aria-hidden=\"true\" data-action=\"local-coodle-todo-uncheck\" data-id=\"' +\n        id +\n        '\"></i></button>';\n    }\n    let button = target.closest('.coodle-checkbutton');\n    button.insertAdjacentHTML(\"afterend\", html);\n    button.remove();\n};\n"],"names":["ACTIONS","SELECTORS","initEventListener","console","log","document","querySelector","addEventListener","e","target","dataset","action","todoCheck","id","directionDelete","todoUncheck","todoCollapse","todoMakeUserTodo","call","methodname","args","parseInt","done","closest","classList","add","switchbuttons","fail","ex","remove","userid","mode","html","button","insertAdjacentHTML"],"mappings":";;;;;;4IA2BMA,cACK,0BADLA,eAEM,gCAFNA,gBAGO,4BAHPA,iBAIQ,6BAJRA,qBAKY,6BAMZC,eACI,gCAMU,KAChBC,oBAGAC,QAAQC,IAAI,iCAMVF,kBAAoB,KACtBG,SAASC,cAAcL,gBAAgBM,iBAAiB,SAAS,SAASC,OAClEC,OAASD,EAAEC,UAEfN,QAAQC,IAAIK,OAAOC,QAAQC,QACtBF,OAAOC,QAAQC,cAKZF,OAAOC,QAAQC,aACdX,cACDY,UAAUH,OAAQA,OAAOC,QAAQG,eAEhCb,eACDc,gBAAgBL,OAAQA,OAAOC,QAAQG,eAEtCb,gBACDe,YAAYN,OAAQA,OAAOC,QAAQG,eAElCb,iBACDgB,aAAaP,OAAQA,OAAOC,QAAQG,eAEnCb,qBACDiB,iBAAiBR,OAAQA,OAAOC,QAAQG,SAjB5CV,QAAQC,IAAI,WA8BlBQ,UAAY,CAACH,OAAQI,oBAClBK,KAAK,CAAC,CACPC,WAAY,2BACZC,KAAM,QACQC,SAASR,WACT,QAEdS,KAAM,WACFb,OAAOc,QAAQ,MAAMC,UAAUC,IAAI,QACnCC,cAAcjB,OAAQ,QAASI,KAEnCc,KAAM,SAASC,IAEXzB,QAAQC,IAAI,MAAQwB,SAU1Bd,gBAAkB,CAACL,OAAQI,oBACxBK,KAAK,CAAC,CACPC,WAAY,gCACZC,KAAM,IACIC,SAASR,KAEnBS,KAAM,WACFb,OAAOc,QAAQ,2BAA2BM,UAE9CF,KAAM,SAASC,IAEXzB,QAAQC,IAAI,MAAQwB,SAU1BX,iBAAmB,CAACR,OAAQI,oBACzBK,KAAK,CAAC,CACPC,WAAY,2BACZC,KAAM,QACQC,SAASR,WACT,YAEdS,KAAM,WACFb,OAAOc,QAAQ,MAAMC,UAAUC,IAAI,aAEvCE,KAAM,SAASC,IAEXzB,QAAQC,IAAI,MAAQwB,SAU1Bb,YAAc,CAACN,OAAQI,oBACpBK,KAAK,CAAC,CACPC,WAAY,2BACZC,KAAM,QACQC,SAASR,WACT,WAEdS,KAAM,WACFb,OAAOc,QAAQ,MAAMC,UAAUK,OAAO,QACtCH,cAAcjB,OAAQ,UAAWI,KAErCc,KAAM,SAASC,IAEXzB,QAAQC,IAAI,MAAQwB,SAS1BZ,aAAgBc,SAElB3B,QAAQC,IAAI,WAAa0B,SAGvBJ,cAAgB,CAACjB,OAAQsB,KAAMlB,UAC7BmB,KAAO,GACC,WAARD,OACAC,KAAO,uHAEPnB,GACA,2HACAA,GACA,mBAEQ,SAARkB,OACAC,KAAO,yHAEPnB,GAAK,mHACLA,GACA,uBAEAoB,OAASxB,OAAOc,QAAQ,uBAC5BU,OAAOC,mBAAmB,WAAYF,MACtCC,OAAOJ"}