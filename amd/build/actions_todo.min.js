define("local_coodle/actions_todo",["exports","core/ajax"],(function(_exports,_ajax){var obj;
/*
   * Coodle todo Event functions
   * @package    local_coodle
   * @copyright  Wunderbyte GmbH <info@wunderbyte.at>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const ACTIONS_CHECK="local-coodle-todo-check",ACTIONS_DELETE="local-coodle-todo-delete",ACTIONS_UNCHECK="local-coodle-todo-uncheck",ACTIONS_COLLAPSE="local-coodle-todo-collapse",ACTIONS_MAKEUSERTODO="local-coodle-todo-usertodo",ACTIONS_UNDOUSERTODO="local-coodle-todo-usertodo-revoke",SELECTORS_DASHBOARD=".coodle-dashboard";_exports.init=()=>{initEventListener()};const initEventListener=()=>{document.querySelector(SELECTORS_DASHBOARD).addEventListener("click",(function(e){let target=e.target;if(console.log(target.dataset.action),target.dataset.action)switch(target.dataset.action){case ACTIONS_CHECK:todoCheck(target,target.dataset.id);break;case ACTIONS_DELETE:todoDelete(target,target.dataset.id);break;case ACTIONS_UNCHECK:todoUncheck(target,target.dataset.id);break;case ACTIONS_COLLAPSE:todoCollapse(target,target.dataset.id);break;case ACTIONS_MAKEUSERTODO:todoMakeUserTodo(target,target.dataset.id);break;case ACTIONS_UNDOUSERTODO:todoUndoUserTodo(target,target.dataset.id)}else console.log("nix")}))},todoCheck=(target,id)=>{_ajax.default.call([{methodname:"local_coodle_change_todo",args:{todoid:parseInt(id),method:"done"},done:function(){target.closest("li").classList.add("done"),switchbuttons(target,"check",id)},fail:function(ex){console.log("ex:"+ex)}}])},todoDelete=(target,id)=>{_ajax.default.call([{methodname:"local_coodle_change_todo",args:{todoid:parseInt(id),method:"delete"},done:function(){target.closest("li").remove()},fail:function(ex){console.log("ex:"+ex)}}])},todoMakeUserTodo=(target,id)=>{_ajax.default.call([{methodname:"local_coodle_change_todo",args:{todoid:parseInt(id),method:"usertodo"},done:function(){target.closest("i").classList.remove("fa-user-o"),target.closest("i").classList.add("fa-user"),target.closest("i").dataset.action="local-coodle-todo-usertodo-revoke",target.closest("button").dataset.action="local-coodle-todo-usertodo-revoke"},fail:function(ex){console.log("ex:"+ex)}}])},todoUndoUserTodo=(target,id)=>{_ajax.default.call([{methodname:"local_coodle_change_todo",args:{todoid:parseInt(id),method:"undousertodo"},done:function(){target.closest("i").classList.remove("fa-user"),target.closest("i").classList.add("fa-user-o"),target.closest("i").dataset.action="local-coodle-todo-usertodo",target.closest("button").dataset.action="local-coodle-todo-usertodo"},fail:function(ex){console.log("ex:"+ex)}}])},todoUncheck=(target,id)=>{_ajax.default.call([{methodname:"local_coodle_change_todo",args:{todoid:parseInt(id),method:"uncheck"},done:function(){target.closest("li").classList.remove("done"),switchbuttons(target,"uncheck",id)},fail:function(ex){console.log("ex:"+ex)}}])},todoCollapse=userid=>{console.log("collapse"+userid)},switchbuttons=(target,mode,id)=>{let html="";"uncheck"==mode&&(html='<button class="btn btn-primary-outline coodle-checkbutton pull-right"data-action="local-coodle-todo-check" data-id="'+id+'"><i class="fa fa-check-square-o fa-2x text-success " aria-hidden="true" data-action="local-coodle-todo-check" data-id="'+id+'"></i></button>'),"check"==mode&&(html='<button class="btn btn-primary-outline coodle-checkbutton pull-right"data-action="local-coodle-todo-uncheck" data-id="'+id+'"><i class="fa fa-play fa-2x text-success " aria-hidden="true" data-action="local-coodle-todo-uncheck" data-id="'+id+'"></i></button>');let button=target.closest(".coodle-checkbutton");button.insertAdjacentHTML("afterend",html),button.remove()}}));

//# sourceMappingURL=actions_todo.min.js.map